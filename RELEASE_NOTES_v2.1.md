# Frida工具箱 v2.1 Release 发布说明

## 版本信息
- **版本号**: v2.1 Release
- **发布日期**: 2024-12-19
- **文件名**: `frida_toolbox_v2.1_release.ps1`
- **状态**: 正式发布版本

## 主要特性

### 🚀 核心功能
- **后台运行模式**: frida-server在后台静默运行，无需打开新终端窗口
- **完整的Job管理系统**: 支持Job创建、监控、停止和自动清理
- **智能环境检测**: 自动检测设备架构和frida环境状态
- **脚本注入管理**: 支持多种脚本注入模式和重连机制

### 🛠 工具集成
- 集成了完整的frida工具链
- 支持Android设备的自动化操作
- 提供了丰富的命令行参数支持
- 包含详细的错误处理和日志记录

## 🐛 本版本修复的问题

### 1. Job管理器错误修复
- **问题**: "op_Subtraction"日期减法错误
- **原因**: Job对象的时间属性类型不匹配
- **解决方案**: 统一使用`CreatedTime`属性进行时间计算
- **影响**: Job运行时间现在能正确显示

### 2. Job ID显示问题
- **问题**: Job ID显示不完整或截断
- **原因**: 数据结构不匹配导致属性访问错误
- **解决方案**: 统一了Job属性映射（`JobId` → `Id`，`Purpose` → `Name`，`Status` → `State`）
- **影响**: Job列表现在能完整显示所有信息

### 3. 数据结构统一
- **问题**: `frida_toolbox_background.ps1`和`job_management_enhancement.ps1`之间数据结构不一致
- **解决方案**: 统一了两个模块之间的Job数据结构
- **影响**: 提升了系统稳定性和可维护性

### 4. 函数重复问题
- **问题**: `Show-JobDetails`函数在多个文件中重复定义
- **解决方案**: 删除了重复函数，统一使用`job_management_enhancement.ps1`中的实现
- **影响**: 减少了代码冗余，避免了潜在的冲突

## 🔧 技术改进

### Job管理增强
- 增加了`IsManaged`属性检查，确保只显示受管理的Job
- 改进了运行时间计算的健壮性
- 优化了Job停止和清理机制

### 错误处理优化
- 增强了异常捕获和处理机制
- 改进了错误信息的可读性
- 添加了更详细的调试信息

### 代码质量提升
- 统一了代码风格和命名规范
- 增加了函数级注释
- 优化了代码结构和可读性

## 📋 使用说明

### 基本用法
```powershell
# 显示帮助信息
.\frida_toolbox_v2.1_release.ps1 -Help

# 直接执行特定选项
.\frida_toolbox_v2.1_release.ps1 -Choice 1

# 交互式运行
.\frida_toolbox_v2.1_release.ps1
```

### 可用选项
1. 完整初始化环境（后台模式）
2. 仅部署frida-server
3. 启动frida-server（后台运行）
4. 仅启动应用
5. 注入脚本
6. 重启应用并注入
7. 检查环境状态
8. 快速重连frida
9. 停止frida-server
0. 退出

## 🧪 测试验证

### 已验证功能
- ✅ Job管理器正常显示Job列表
- ✅ Job ID完整显示
- ✅ 运行时间正确计算
- ✅ 无"op_Subtraction"错误
- ✅ Job停止和清理功能正常
- ✅ 所有核心功能稳定运行

### 测试环境
- Windows PowerShell 5.x
- Frida 17.2.15
- Android设备/模拟器

## 📁 相关文件

### 核心文件
- `frida_toolbox_v2.1_release.ps1` - 主程序（正式版本）
- `job_management_enhancement.ps1` - Job管理模块
- `frida_toolbox_background.ps1` - 开发版本

### 文档文件
- `README.md` - 项目说明
- `Frida注入操作流程.md` - 操作流程说明
- `Frida脚本加载操作指南.md` - 脚本加载指南
- `脚本使用说明.md` - 详细使用说明

## 🔄 升级说明

如果您正在使用旧版本，建议：
1. 备份当前配置和脚本
2. 使用新的正式版本文件
3. 验证Job管理功能是否正常
4. 如有问题，可回退到备份版本

## 🐛 已知问题

目前没有已知的严重问题。如果发现任何问题，请及时反馈。

## 📞 支持

如需技术支持或报告问题，请参考项目文档或联系开发团队。

---

**注意**: 这是一个稳定的正式发布版本，建议在生产环境中使用此版本。